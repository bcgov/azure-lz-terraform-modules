{
  "name": "Deny-Delete-NetworkWatcher",
  "type": "Microsoft.Authorization/policyAssignments",
  "apiVersion": "2019-09-01",
  "properties": {
    "displayName": "Deny Deleting Network Watcher Flow Logs",
    "description": "TThis Policy will prevent users from deleting the Network Watcher Flow Logs.",
    "notScopes": [],
    "parameters": {
      "Network-Watcher-storageId": {
        "value": ""
      },
      "Network-Watcher-workspaceResourceId": {
        "value": ""
      }
    },
    "policyDefinitionId": "${root_scope_resource_id}/providers/Microsoft.Authorization/policyDefinitions/Deny-Delete-NetworkWatcher",
    "nonComplianceMessages": [
      {
        "message": "Deletion of the Network Watcher VNet Flow Logs in the Landing Zones is not allowed. If you require access to the VNet Flow Logs, please create your own Storage Account, Log Analytics Workspace, and Network Watcher resources."
      }
    ],
    "scope": "${current_scope_resource_id}",
    "enforcementMode": "Default"
  },
  "location": "${default_location}",
  "identity": {
    "type": "SystemAssigned"
  }
}
